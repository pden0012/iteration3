<template>
  <div class="dashboard">
    <!-- Page Container - Center column with side gutters -->
    <!-- È°µÈù¢ÂÆπÂô® - ‰∏≠ÂøÉÊ†èÂä†‰∏§‰æßÁïôÁôΩÂ∏ÉÂ±Ä -->
    <div class="page-container">
      
      <!-- Header Section - Title, timestamp and location dropdown -->
      <!-- Â§¥ÈÉ®Âå∫Âüü - Ê†áÈ¢ò„ÄÅÊó∂Èó¥Êà≥ÂíåÂú∞ÁÇπ‰∏ãÊãâÊ°Ü -->
      <header class="dashboard-header">
        <div class="header-left">
          <h1 class="dashboard-title">{{ dashboardData.title }}</h1>
          <p class="last-updated">{{ dashboardData.lastUpdated }}</p>
        </div>
        <div class="header-right">
          <!-- Location autocomplete -->
          <!-- Âú∞ÁÇπÊêúÁ¥¢ËÅîÊÉ≥ËæìÂÖ•Ê°ÜÔºöÂè™ËÉΩ‰ªéCSVÊèê‰æõÁöÑÂàóË°®‰∏≠ÈÄâÊã© -->
          <div class="location-select">
            <div class="autocomplete">
              <input
                v-model="locationQuery"
                @input="onQueryChange"
                @focus="openSuggestions"
                @keydown.enter.prevent="confirmFirstSuggestion"
                type="text"
                class="location-input"
                placeholder="Search suburb"
                autocomplete="off"
              />
              <ul v-if="showSuggestions && filteredAddresses.length" class="suggestions">
                <li
                  v-for="addr in filteredAddresses"
                  :key="addr"
                  @mousedown.prevent="selectAddress(addr)"
                  class="suggestion-item"
                >{{ addr }}</li>
              </ul>
            </div>
            <button class="confirm-button" @click="confirmLocation">Confirm</button>
          </div>
        </div>
      </header>

      <!-- Main Content Grid - Two column layout -->
      <!-- ‰∏ªÂÜÖÂÆπÁΩëÊ†º - ÂèåÂàóÂ∏ÉÂ±Ä -->
      <section class="main-content">
        <div class="content-grid">
          
          <!-- Left Column - Pollen Index Chart -->
          <!-- Â∑¶Ê†è - Ëä±Á≤âÊåáÊï∞ÂõæË°® -->
          <div class="chart-section">
            <h3 class="section-title">{{ chartData.title }}</h3>
            <div class="chart-container">
              <!-- Circular pollen index chart -->
              <!-- ÂúÜÂΩ¢Ëä±Á≤âÊåáÊï∞ÂõæË°® -->
              <div class="pollen-chart">
                <!-- Donut ring driven by CSS variables -->
                <!-- ÁéØÂΩ¢ËøõÂ∫¶Êù°Ôºö‰ΩøÁî®CSSÂèòÈáèÈ©±Âä®ËøõÂ∫¶‰∏éÈ¢úËâ≤ -->
                <div
                  class="chart-circle"
                  :style="{ '--progress': pollenProgress, '--ring-color': chartRingColor }"
                >
                  <!-- center text -->
                  <!-- ‰∏≠Èó¥Á≠âÁ∫ßÊñáÂ≠ó -->
                  <div class="chart-center">
                    <span class="pollen-level" :style="{ color: chartTextColor }">{{ pollenData.level }}</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- View Forecast Button -->
            <!-- Êü•ÁúãÈ¢ÑÊä•ÊåâÈíÆ -->
            <button class="forecast-button" @click="viewForecast">
              {{ chartData.forecastButton }}
            </button>

            
          </div>

          <!-- Right Column - Allergen Levels List -->
          <!-- Âè≥Ê†è - ËøáÊïèÂéüÁ≠âÁ∫ßÂàóË°® -->
          <div class="allergen-section">
            <!-- Alert banner above allergen levels -->
            <!-- ËøáÊïèÂéüÁ≠âÁ∫ß‰∏äÊñπÁöÑË≠¶Êä•Ê®™ÂπÖ -->
            <div class="alert-banner" :class="alertVariant">
              <span class="alert-text">üå§Ô∏è {{ alertMessage }}</span>
            </div>
            
            <h3 class="section-title">{{ allergenData.title }}</h3>
            
            <!-- Allergen levels list -->
            <!-- ËøáÊïèÂéüÁ≠âÁ∫ßÂàóË°® -->
            <div class="allergen-list">
              <div 
                v-for="allergen in allergenData.levels" 
                :key="allergen.id"
                class="allergen-item"
              >
                <div class="allergen-info">
                  <div class="allergen-icon">
                    <img :src="allergen.icon" :alt="allergen.name + ' icon'" />
                  </div>
                  <span class="allergen-name">{{ allergen.name }}</span>
                </div>
                <span class="allergen-level" :class="allergen.levelClass">
                  {{ allergen.level }}
                </span>
              </div>
            </div>
            
            <!-- Quiz CTA -->
            <!-- ÊµãÈ™åË°åÂä®Âè∑Âè¨ -->
            <div class="quiz-cta">
              <p class="quiz-question">{{ quizData.question }}</p>
              <button class="quiz-button" @click="takeQuiz">
                {{ quizData.buttonText }}
              </button>
            </div>
          </div>

        </div>
      </section>

      <!-- Climate & Dispersion Section below the main dashboard -->
      <!-- Ê∞îÂÄô‰∏éÊâ©Êï£ÂèØËßÜÂåñÔºöÊå™Âá∫ÂèåÂàóÁΩëÊ†ºÔºåÊï¥‰ΩìÂ±Ö‰∏≠ÊòæÁ§∫ -->
      <section class="climate-section">
        <!-- Scatter plot: rainfall vs wind with medians -->
        <!-- Êï£ÁÇπÂõæÔºöÈôçÈõ® vs È£éÈÄüÔºåÂπ∂Â∏¶Êúâ‰∏≠‰ΩçÊï∞ËôöÁ∫ø -->
        <div class="viz-card">
          <h4 class="viz-title">Melbourne ‚Äî Pollen-friendly vs Pollen-suppressing months</h4>
          <svg
            v-if="scatterViz"
            class="chart-svg"
            :width="scatterViz.width"
            :height="scatterViz.height"
            role="img"
            aria-label="Monthly average rainfall versus wind speed scatter plot"
          >
            <!-- Axes -->
            <line :x1="scatterViz.padLeft" :y1="scatterViz.padTop + scatterViz.plotH" :x2="scatterViz.padLeft + scatterViz.plotW" :y2="scatterViz.padTop + scatterViz.plotH" class="axis" />
            <line :x1="scatterViz.padLeft" :y1="scatterViz.padTop" :x2="scatterViz.padLeft" :y2="scatterViz.padTop + scatterViz.plotH" class="axis" />

            <!-- Median dashed lines -->
            <line :x1="scatterViz.medianX" :y1="scatterViz.padTop" :x2="scatterViz.medianX" :y2="scatterViz.padTop + scatterViz.plotH" class="median-line" />
            <line :x1="scatterViz.padLeft" :y1="scatterViz.medianY" :x2="scatterViz.padLeft + scatterViz.plotW" :y2="scatterViz.medianY" class="median-line" />

            <!-- Points -->
            <g v-for="pt in scatterViz.points" :key="pt.month">
              <circle :cx="pt.x" :cy="pt.y" r="5" class="dot" />
              <text :x="pt.x + 6" :y="pt.y - 6" class="dot-label">{{ pt.month_abbr }}</text>
            </g>

            <!-- Axis labels -->
            <text :x="scatterViz.padLeft + scatterViz.plotW/2" :y="scatterViz.padTop + scatterViz.plotH + 32" class="axis-label" text-anchor="middle">Monthly average rainfall (mm)</text>
            <text :x="scatterViz.padLeft - 34" :y="scatterViz.padTop + scatterViz.plotH/2" class="axis-label" transform="rotate(-90, {{scatterViz.padLeft - 34}}, {{scatterViz.padTop + scatterViz.plotH/2}})" text-anchor="middle">Monthly average wind (km/h)</text>
          </svg>
        </div>

        <!-- Stacked bar: seasonal contributions -->
        <!-- Â†ÜÂè†Êù°ÂΩ¢ÂõæÔºö‰∏çÂêåÂ≠£ËäÇ‰∏âÁßçÂõ†Á¥†Ë¥°ÁåÆ -->
        <div class="viz-card">
          <h4 class="viz-title">Melbourne ‚Äî What‚Äôs driving dispersion by season?</h4>
          <svg
            v-if="stackedViz"
            class="chart-svg"
            :width="stackedViz.width"
            :height="stackedViz.height"
            role="img"
            aria-label="Seasonal stacked contributions chart"
          >
            <!-- Axes -->
            <line :x1="stackedViz.padLeft" :y1="stackedViz.padTop + stackedViz.plotH" :x2="stackedViz.padLeft + stackedViz.plotW" :y2="stackedViz.padTop + stackedViz.plotH" class="axis" />
            <line :x1="stackedViz.padLeft" :y1="stackedViz.padTop" :x2="stackedViz.padLeft" :y2="stackedViz.padTop + stackedViz.plotH" class="axis" />

            <!-- Bars -->
            <g v-for="bar in stackedViz.bars" :key="bar.season">
              <g v-for="seg in bar.segments" :key="seg.key">
                <rect :x="bar.x" :y="seg.y" :width="bar.width" :height="seg.h" :fill="seg.color" />
              </g>
              <text :x="bar.x + bar.width/2" :y="stackedViz.padTop + stackedViz.plotH + 16" class="tick" text-anchor="middle">{{ bar.shortLabel }}</text>
            </g>

            <!-- Legend -->
            <g class="legend" :transform="`translate(${stackedViz.padLeft}, ${stackedViz.padTop - 10})`">
              <g v-for="(lg, i) in stackedViz.legend" :key="lg.key" :transform="`translate(${i*140}, 0)`">
                <rect width="12" height="12" :fill="lg.color" rx="2" ry="2" />
                <text x="18" y="11" class="legend-label">{{ lg.label }}</text>
              </g>
            </g>
          </svg>
        </div>

        <!-- Short centered explanation below charts -->
        <!-- ÂõæË°®‰∏ãÊñπÁöÑÁÆÄÁü≠ËØ¥ÊòéÔºöËã±ÊñáÂÜÖÂÆπÔºå‰øùÊåÅÁÆÄÊ¥ÅÂπ∂Â±Ö‰∏≠ÂØπÈΩê -->
        <p class="viz-note">
          Wind, fewer rainy days and drier afternoon air make pollen spread farther. 
          Use this view to spot months and seasons when dispersion is likely higher in Melbourne.
        </p>
      </section>

    </div>

    <!-- Blue separator bar -->
    <!-- ËìùËâ≤ÂàÜÈöîÊù° -->
    <div class="separator-bar"></div>

    <!-- Tips Section - Quick tips and advice -->
    <!-- ÊèêÁ§∫Âå∫Âüü - Âø´ÈÄüÊèêÁ§∫ÂíåÂª∫ËÆÆ -->
    <section class="tips-section">
      <div class="tips-container">
        <div class="tips-content">
          <!-- Left section - icon and title -->
          <!-- Â∑¶‰æßÂå∫Âüü - ÂõæÊ†áÂíåÊ†áÈ¢ò -->
          <div class="tips-left">
            <div class="tips-icon">
              <img src="/images/prototype images/image.png" alt="Tips icon" />
            </div>
            <h2 class="tips-title">{{ tipsData.title }}</h2>
          </div>
          
          <!-- Right section - text content -->
          <!-- Âè≥‰æßÂå∫Âüü - ÊñáÊú¨ÂÜÖÂÆπ -->
          <div class="tips-text">
            <p class="tip-main">{{ tipsData.mainTip }}</p>
            <p class="tip-description">{{ tipsData.description }}</p>
          </div>
        </div>
      </div>
    </section>

  </div>
</template>

<script>
// Import climate JSON data for local rendering
// ÂºïÂÖ•Êú¨Âú∞JSONÊï∞ÊçÆÔºåÁî®‰∫éÂèØËßÜÂåñÊ∏≤ÊüìÔºàÈÅøÂÖçÁΩëÁªúËØ∑Ê±ÇÁöÑ‰∏çÁ°ÆÂÆöÊÄßÔºâ
import scatterJson from '../../Iteration 1 Data/melbourne_scatter_points.json';
import seasonalJson from '../../Iteration 1 Data/melbourne_seasonal_contributions.json';
export default {
  name: 'Dashboard',
  data() {
    return {
      // Dashboard main data - È°µÈù¢‰∏ªË¶Å‰ø°ÊÅØ
      // Dashboard‰∏ªË¶ÅÊï∞ÊçÆ
      dashboardData: {
        title: 'Pollen & Allergen Tracker',
        lastUpdated: 'Last updated 21-08-2025 11:43'
      },
      
      // Chart section data - ÂõæË°®Âå∫ÂüüÊï∞ÊçÆ
      // ÂõæË°®Âå∫ÂüüÊï∞ÊçÆ
      chartData: {
        title: 'Current Pollen Index',
        size: '342 x 342', // ÂõæË°®Â∞∫ÂØ∏ÊòæÁ§∫
        forecastButton: 'View 7-day Forecast'
      },
      
      // Pollen data - current level and progress
      // Ëä±Á≤âÊï∞ÊçÆ - ÂΩìÂâçÁ≠âÁ∫ßÂíåËøõÂ∫¶
      pollenData: {
        level: 'Low', // ÂΩìÂâçËä±Á≤âÁ≠âÁ∫ßÔºöLow/Medium/High
        // ËøôÈáåÂ∞ÜÊù•‰ºöËøûÊé•ÂÆûÈôÖÁöÑËä±Á≤âÊï∞ÊçÆAPI - Will connect to actual pollen data API
      },
      
      // Allergen levels data - right column list
      // ËøáÊïèÂéüÁ≠âÁ∫ßÊï∞ÊçÆ - Âè≥Ê†èÂàóË°®
      allergenData: {
        title: 'Current Allergen Levels',
        levels: [
          {
            id: 'tree',
            name: 'Tree',
            level: 'Moderate',
            levelClass: 'moderate',
            icon: '/images/prototype images/image copy.png', // Ê†ëÊú®ÂõæÊ†á
            iconColor: '#4CAF50' // ÁªøËâ≤
            // Êï∞ÊçÆÊù•Ê∫êÔºöÂ∞ÜÊù•ËøûÊé•ËøáÊïèÂéüÁõëÊµãAPI - Data source: Will connect to allergen monitoring API
          },
          {
            id: 'grass',
            name: 'Grass', 
            level: 'Moderate',
            levelClass: 'moderate',
            icon: '/images/prototype images/image copy 2.png', // ËçâÂú∞ÂõæÊ†á
            iconColor: '#8BC34A' // ÊµÖÁªøËâ≤
          },
          {
            id: 'ragweed',
            name: 'Ragweed',
            level: 'Moderate', 
            levelClass: 'moderate',
            icon: '/images/prototype images/image copy 3.png', // Ë±öËçâÂõæÊ†á
            iconColor: '#2E7D32' // Ê∑±ÁªøËâ≤
          },
          {
            id: 'dust',
            name: 'Dust',
            level: 'Moderate',
            levelClass: 'moderate', 
            icon: '/images/prototype images/image copy 4.png', // ÁÅ∞Â∞òÂõæÊ†á
            iconColor: '#FFC107' // ÈªÑËâ≤
          }
        ]
      },
      
      // Quiz CTA data - ÊµãÈ™åË°åÂä®Âè∑Âè¨Êï∞ÊçÆ
      // ÊµãÈ™åË°åÂä®Âè∑Âè¨Êï∞ÊçÆ
      quizData: {
        question: 'Not sure which affects you?',
        buttonText: 'Take the Quiz'
      },
      
      // Tips section data - ÊèêÁ§∫Âå∫ÂüüÊï∞ÊçÆ
      // ÊèêÁ§∫Âå∫ÂüüÊï∞ÊçÆ
      tipsData: {
        title: 'Quick Tip',
        mainTip: 'Shower and change clothes as soon as you come indoors.',
        description: 'This helps wash pollen off your skin and hair, and prevents it from spreading onto your bedding and furniture, reducing nighttime symptoms.'
      },
      
      // Interactive state - ‰∫§‰∫íÁä∂ÊÄÅ
      // ‰∫§‰∫íÁä∂ÊÄÅ
      selectedLocation: '', // ÂΩìÂâçÈÄâÊã©ÁöÑÂüéÂ∏ÇÔºàÊ†áÂáÜÂåñÈÉäÂå∫ÂêçÔºâ
      locationQuery: 'Melbourne', // ËæìÂÖ•Ê°Ü‰∏≠ÁöÑÊêúÁ¥¢ÂÖ≥ÈîÆËØç
      addressList: [], // ÊâÄÊúâÂèØÈÄâÂú∞ÂùÄÔºàÊù•Ëá™CSVÔºâ
      filteredAddresses: [], // ËøáÊª§ÂêéÁöÑÂÄôÈÄâ
      showSuggestions: false, // ÊòØÂê¶Â±ïÁ§∫Âª∫ËÆÆÂàóË°®
      alertMessage: 'Great day to enjoy the outdoors!', // Ë≠¶Êä•Ê∂àÊÅØ
      alertVariant: 'normal', // ÊèêÁ§∫Ê†∑Âºè normal(ÈªÑËâ≤) / danger(Á∫¢Ëâ≤)
      pollenProgress: 25, // Ëä±Á≤âÊåáÊï∞ËøõÂ∫¶ (0-100) - Â∞ÜÊù•‰ªéAPIËé∑Âèñ - Will fetch from API
      chartRingColor: '#C8E6C9', // ÁéØÂΩ¢È¢úËâ≤ÔºåÈöèÊï¥‰ΩìÁ≠âÁ∫ßÂèòÂåñ
      chartTextColor: '#1E1E1E'  // ÂúÜÂøÉÊñáÂ≠óÈ¢úËâ≤ÔºåÈöèÊï¥‰ΩìÁ≠âÁ∫ßÂèòÂåñ
      ,
      // Visualization states - Êú¨Âú∞ÂèØËßÜÂåñÁä∂ÊÄÅÊï∞ÊçÆ
      scatterViz: null,   // Êï£ÁÇπÂõæÂá†‰Ωï‰∏éÁÇπ‰Ωç
      stackedViz: null    // Â†ÜÂè†Êù°ÂΩ¢ÂõæÂá†‰Ωï‰∏éÊü±ÊÆµ
    }
  },
  
  methods: {
    // Update the "Last updated" timestamp to current local time (dd-MM-YYYY HH:mm)
    updateLastUpdated() {
      const pad = (n) => String(n).padStart(2, '0');
      const now = new Date();
      const hours24 = now.getHours();
      const ampm = hours24 >= 12 ? 'PM' : 'AM';
      const hours12 = hours24 % 12 === 0 ? 12 : hours24 % 12;
      const formatted = `${pad(now.getDate())}-${pad(now.getMonth() + 1)}-${now.getFullYear()} ${pad(hours12)}:${pad(now.getMinutes())} ${ampm}`;
      this.dashboardData.lastUpdated = `Last updated ${formatted}`;
    },
    // View forecast action - Êü•ÁúãÈ¢ÑÊä•Ë°åÂä®
    // Êü•ÁúãÈ¢ÑÊä•Ë°åÂä®
    viewForecast() {
      console.log('Viewing 7-day forecast...');
      // ËøôÈáåÂ∞ÜÂÆûÁé∞7Â§©È¢ÑÊä•ÂäüËÉΩ - Will implement 7-day forecast functionality
    },
    
    // Take quiz action - ÂèÇÂä†ÊµãÈ™åË°åÂä®
    // ÂèÇÂä†ÊµãÈ™åË°åÂä®
    takeQuiz() {
      console.log('Starting allergen quiz...');
      // ËøôÈáåÂ∞ÜÂÆûÁé∞ËøáÊïèÂéüÊµãÈ™åÂäüËÉΩ - Will implement allergen quiz functionality
    },
    
    // ÂàùÂßãÂåñÔºöËØªÂèñCSVÂú∞ÂùÄ
    async loadAddresses() {
      try {
        const res = await fetch('/address/address.csv');
        const text = await res.text();
        const lines = text.split(/\r?\n/).map(l => l.trim()).filter(Boolean);
        const addresses = lines.map(l => l.split(',')[0].trim()).filter(Boolean);
        this.addressList = Array.from(new Set(addresses));
        this.filteredAddresses = this.filterByQuery(this.locationQuery);
      } catch (e) {
        console.error('Failed to load addresses CSV', e);
      }
    },

    // Initialize local climate visualizations (scatter + stacked)
    // ÂàùÂßãÂåñÊú¨Âú∞Ê∞îÂÄôÂèØËßÜÂåñÔºàÊï£ÁÇπ + Â†ÜÂè†Êü±Áä∂Ôºâ
    initClimateViz() {
      try {
        this.scatterViz = this.buildScatterViz(scatterJson);
      } catch (e) {
        console.error('Failed to init scatter viz', e);
      }
      try {
        this.stackedViz = this.buildStackedViz(seasonalJson);
      } catch (e) {
        console.error('Failed to init stacked viz', e);
      }
    },

    // Build scatter-plot geometry from JSON
    // Ê†πÊçÆJSONËÆ°ÁÆóÊï£ÁÇπÂõæÂá†‰Ωï
    buildScatterViz(json) {
      const width = 560;    // SVG intrinsic width
      const height = 380;   // SVG intrinsic height
      const padLeft = 56;
      const padRight = 16;
      const padTop = 18;
      const padBottom = 46;
      const plotW = width - padLeft - padRight;
      const plotH = height - padTop - padBottom;
      const points = Array.isArray(json?.points) ? json.points : [];
      const rainVals = points.map(p => p.rain_mm);
      const windVals = points.map(p => p.wind_kmh);
      const minRain = Math.min(...rainVals);
      const maxRain = Math.max(...rainVals);
      const minWind = Math.min(...windVals);
      const maxWind = Math.max(...windVals);
      const xScale = (v) => padLeft + ((v - minRain) / (maxRain - minRain)) * plotW;
      const yScale = (v) => padTop + (1 - (v - minWind) / (maxWind - minWind)) * plotH;
      const mapped = points.map(p => ({
        ...p,
        x: xScale(p.rain_mm),
        y: yScale(p.wind_kmh)
      }));
      const rainMed = Number(json?.medians?.rain_median ?? (minRain + maxRain) / 2);
      const windMed = Number(json?.medians?.wind_median ?? (minWind + maxWind) / 2);
      return {
        width, height, padLeft, padTop, plotW, plotH,
        points: mapped,
        medianX: xScale(rainMed),
        medianY: yScale(windMed)
      };
    },

    // Build stacked bars geometry from JSON
    // Ê†πÊçÆJSONËÆ°ÁÆóÂ†ÜÂè†Êü±ÂΩ¢ÂõæÂá†‰Ωï
    buildStackedViz(json) {
      const width = 560;
      const height = 340;
      const padLeft = 56;
      const padRight = 16;
      const padTop = 28;
      const padBottom = 40;
      const plotW = width - padLeft - padRight;
      const plotH = height - padTop - padBottom;
      const data = Array.isArray(json?.data) ? json.data : [];
      const barGap = 22;
      const barWidth = (plotW - barGap * (data.length - 1)) / Math.max(data.length, 1);
      const colors = {
        wind: '#4A9EFF',         // wind (dispersion) - blue
        dryDays: '#F2A737',      // dry days - orange
        dryAir: '#82D9B4'        // dry air - mint green
      };
      const bars = data.map((row, i) => {
        const x = padLeft + i * (barWidth + barGap);
        // Values are relative contributions; sum ‚â§ 1
        const vWind = Number(row.contrib_wind || 0);
        const vDryDays = Number(row.contrib_dry_days || 0);
        const vDryAir = Number(row.contrib_dry_air || 0);
        // Scale to plot height
        const hWind = vWind * plotH;
        const hDryDays = vDryDays * plotH;
        const hDryAir = vDryAir * plotH;
        const yWind = padTop + plotH - hWind;
        const yDryDays = yWind - hDryDays;
        const yDryAir = yDryDays - hDryAir;
        return {
          season: row.season,
          shortLabel: (row.season || '').split(' ')[0],
          x,
          width: barWidth,
          segments: [
            { key: 'wind', y: yWind, h: hWind, color: colors.wind },
            { key: 'dryDays', y: yDryDays, h: hDryDays, color: colors.dryDays },
            { key: 'dryAir', y: yDryAir, h: hDryAir, color: colors.dryAir }
          ]
        };
      });
      const legend = [
        { key: 'wind', label: 'Wind (dispersion)', color: colors.wind },
        { key: 'dryDays', label: 'Dry days (less rain)', color: colors.dryDays },
        { key: 'dryAir', label: 'Dry air (lower 3pm humidity)', color: colors.dryAir }
      ];
      return { width, height, padLeft, padTop, plotW, plotH, bars, legend };
    },

    // ÊñáÊú¨ÂèòÂåñÔºöËøáÊª§
    onQueryChange() {
      this.filteredAddresses = this.filterByQuery(this.locationQuery);
      this.showSuggestions = true;
    },
    openSuggestions() {
      this.filteredAddresses = this.filterByQuery(this.locationQuery);
      this.showSuggestions = true;
    },
    confirmFirstSuggestion() {
      if (this.filteredAddresses.length) this.selectAddress(this.filteredAddresses[0]);
    },
    filterByQuery(q) {
      const query = (q || '').toLowerCase();
      if (!query) return this.addressList.slice(0, 20);
      return this.addressList.filter(a => a.toLowerCase().includes(query)).slice(0, 20);
    },
    selectAddress(addr) {
      this.locationQuery = addr;
      this.showSuggestions = false;
    },

    // Áî®Êà∑ÁÇπÂáªÁ°ÆËÆ§ÂêéÊâçÂèëËµ∑ËØ∑Ê±Ç
    confirmLocation() {
      const match = this.addressList.find(a => a.toLowerCase() === this.locationQuery.toLowerCase());
      if (match) {
        this.selectedLocation = match;
        this.loadDataForLocation(this.selectedLocation);
        this.updateLastUpdated();
      } else {
        // Ëã•Êú™Á≤æÁ°ÆÂåπÈÖçÔºåÂ∞ùËØï‰ΩøÁî®Á¨¨‰∏Ä‰∏™ÂÄôÈÄâ
        if (this.filteredAddresses.length) {
          this.selectedLocation = this.filteredAddresses[0];
          this.locationQuery = this.selectedLocation;
          this.loadDataForLocation(this.selectedLocation);
          this.updateLastUpdated();
        }
      }
    },
    
    // Load data for specific location - ‰∏∫ÁâπÂÆöÂú∞ÁÇπÂä†ËΩΩÊï∞ÊçÆ
    // ‰∏∫ÁâπÂÆöÂú∞ÁÇπÂä†ËΩΩÊï∞ÊçÆ
    async loadDataForLocation(location) {
      try {
        // Ê†πÊçÆÁéØÂ¢ÉÈÄâÊã©API URL
        const isDev = import.meta.env.DEV;
        let url;
        if (isDev) {
          url = `/api/dashboard?suburb=${encodeURIComponent(location)}&format=json`;
        } else {
          // Áîü‰∫ßÁéØÂ¢É‰ΩøÁî®CORS‰ª£ÁêÜËß£ÂÜ≥Mixed ContentÈóÆÈ¢ò
          const backendUrl = `http://13.236.162.216:8080/dashboard?suburb=${encodeURIComponent(location)}&format=json`;
          url = `https://api.allorigins.win/raw?url=${encodeURIComponent(backendUrl)}`;
        }
        const res = await fetch(url);
        const json = await res.json();
        const item = Array.isArray(json?.data) ? (json.data[0] || {}) : (json?.data || {});
        const toLevel = (v) => this.mapBackendLevelToUi(String(v || '').toLowerCase());

        if (item.pollen) {
          this.pollenData.level = this.mapBackendLevelToUi(String(item.pollen).toLowerCase());
          this.pollenProgress = this.levelToProgress(this.pollenData.level);
        }

        const mapping = {
          // first three are pollen category ‚Üí use pollen scale
          tree: this.mapPollenLevel(toLevel(item.tree)),
          grass: this.mapPollenLevel(toLevel(item.grass)),
          ragweed: this.mapPollenLevel(toLevel(item.ragweed)),
          // dust: align to pollen scale (Good‚ÜíVery Low, Fair‚ÜíLow, Poor‚ÜíModerate, Very Poor‚ÜíHigh, Extremely Poor‚ÜíVery High)
          dust: (() => {
            const dustUi = this.mapBackendLevelToUi(String(item.dust || '').toLowerCase());
            if (dustUi === 'Good') return 'Very Low';
            if (dustUi === 'Fair') return 'Low';
            if (dustUi === 'Poor') return 'Moderate';
            if (dustUi === 'Very Poor') return 'High';
            if (dustUi === 'Extremely Poor') return 'Very High';
            return 'None';
          })()
        };
        this.allergenData.levels = this.allergenData.levels.map(row => {
          const key = row.id;
          const level = mapping[key] || row.level;
          return { ...row, level, levelClass: this.levelToClass(level, key) };
        });

        // Recalculate overall index based on four items
        // Ê†πÊçÆÂõõ‰∏™È°πÁõÆÈáçÊñ∞ËÆ°ÁÆóÊï¥‰ΩìÊåáÊï∞
        this.recalculateOverallIndex();
      } catch (e) {
        console.error('Failed to fetch dashboard data', e);
      }
    },

    mapBackendLevelToUi(v) {
      // Keep the exact backend terms but normalize capitalization
      // ‰øùÊåÅÂêéÁ´ØÂéüËØçÔºå‰ªÖÁªü‰∏ÄÂ§ßÂ∞èÂÜôÈ£éÊ†º
      if (!v || v === 'null' || v === 'none') return 'Unknown';
      if (v.includes('very low')) return 'Very Low';
      if (v === 'low') return 'Low';
      if (v === 'moderate' || v === 'medium') return 'Moderate';
      if (v === 'high') return 'High';
      if (v === 'very high') return 'Very High';
      if (v === 'good') return 'Good';
      if (v === 'fair') return 'Fair';
      if (v === 'poor') return 'Poor';
      if (v === 'very poor') return 'Very Poor';
      if (v === 'extremely poor') return 'Extremely Poor';
      if (v === 'no data') return 'None';
      return v.charAt(0).toUpperCase() + v.slice(1);
    },

    // normalize pollen values to one of: None, Very Low, Low, Moderate, High, Very High
    // ËßÑËåÉÂåñËä±Á≤âÁ≠âÁ∫ß
    mapPollenLevel(v) {
      const l = (v || '').toLowerCase();
      if (!l || l === 'unknown' || l === 'none' || l === 'no data') return 'None';
      if (l.includes('very low')) return 'Very Low';
      if (l === 'low') return 'Low';
      if (l === 'moderate' || l === 'medium') return 'Moderate';
      if (l === 'high') return 'High';
      if (l === 'very high') return 'Very High';
      return 'None';
    },

    // normalize dust values to one of: None, Good, Fair, Poor, Very Poor, Extremely Poor
    // ËßÑËåÉÂåñÁ≤âÂ∞òÁ≠âÁ∫ß
    mapDustLevel(v) {
      const l = (v || '').toLowerCase();
      if (!l || l === 'unknown' || l === 'none' || l === 'no data') return 'None';
      if (l === 'good') return 'Good';
      if (l === 'fair') return 'Fair';
      if (l === 'poor') return 'Poor';
      if (l === 'very poor') return 'Very Poor';
      if (l === 'extremely poor') return 'Extremely Poor';
      return 'None';
    },
    levelToClass(level, key) {
      const l = (level || '').toLowerCase();
      // We have aligned dust to pollen scale, so all categories share the same classes
      if (l === 'none') return 'none';
      if (l.includes('very low')) return 'very-low';
      if (l === 'low') return 'low';
      if (l === 'moderate') return 'moderate';
      if (l === 'high') return 'high';
      if (l === 'very high') return 'very-high';
      return 'none';
    },
    levelToProgress(level) {
      const l = (level || '').toLowerCase();
      if (l.includes('very low')) return 10;
      if (l === 'low') return 25;
      if (l === 'moderate') return 55;
      if (l === 'high') return 75;
      if (l === 'very high') return 90;
      return 30;
    },

    // Convert a level to numeric score (1-5) by category
    // ÊåâÁ±ªÂà´ÊääÁ≠âÁ∫ßËΩ¨Êç¢‰∏∫ÂàÜÊï∞(1-5)
    levelToScore(key, level) {
      const l = (level || '').toLowerCase();
      // For dust we have aligned to pollen scale already, so score using pollen rules too
      if (l === 'none') return null;
      if (l.includes('very low')) return 1;
      if (l === 'low') return 2;
      if (l === 'moderate') return 3;
      if (l === 'high') return 4;
      if (l === 'very high') return 5;
      return null;
    },

    // Compute average score and update left chart
    // ËÆ°ÁÆóÂπ≥ÂùáÂàÜÂπ∂Êõ¥Êñ∞Â∑¶‰æßÂúÜÁéØ
    recalculateOverallIndex() {
      const scores = this.allergenData.levels
        .map(row => this.levelToScore(row.id, row.level))
        .filter(v => typeof v === 'number');
      if (!scores.length) {
        this.pollenData.level = 'None';
        this.pollenProgress = 10;
        this.chartRingColor = this.colorForOverall('None');
        this.chartTextColor = this.textColorForOverall('None');
        const advisory = this.advisoryForLevel('Very Low');
        this.alertMessage = advisory.message;
        this.alertVariant = advisory.variant;
        return;
      }
      const avg = scores.reduce((a, b) => a + b, 0) / scores.length;
      const rounded = Math.round(avg); // 1..5
      const labels = ['Very Low', 'Low', 'Moderate', 'High', 'Very High'];
      const level = labels[Math.max(1, Math.min(5, rounded)) - 1];
      this.pollenData.level = level;
      // map to progress: 1->10, 2->30, 3->50, 4->70, 5->90
      this.pollenProgress = 10 + (rounded - 1) * 20;
      this.chartRingColor = this.colorForOverall(level);
      this.chartTextColor = this.textColorForOverall(level);
      const advisory = this.advisoryForLevel(level);
      this.alertMessage = advisory.message;
      this.alertVariant = advisory.variant;
    },

    // Color for the donut by overall level
    // Ê†πÊçÆÊï¥‰ΩìÁ≠âÁ∫ßËøîÂõûÂúÜÁéØÈ¢úËâ≤
    colorForOverall(level) {
      const l = (level || '').toLowerCase();
      // Use the same background colors as right badges
      // ‰ΩøÁî®‰∏éÂè≥‰æßÂæΩÁ≠æÁõ∏ÂêåÁöÑËÉåÊôØËâ≤
      if (l === 'none') return '#EEEEEE';
      if (l.includes('very low')) return '#5CB88F'; /* darker mint */
      if (l === 'low') return '#8AD9BC';            /* slightly deeper */
      if (l === 'moderate') return '#FFD79A';       /* vivid orange */
      if (l === 'high') return '#FFA8A8';           /* vivid light red */
      if (l === 'very high') return '#FF7A7A';      /* vivid red */
      return '#9EE6C6';
    },

    // Text color for overall level (slightly deeper tone of ring color)
    // ÊñáÊú¨È¢úËâ≤ÔºöÊ†πÊçÆÁ≠âÁ∫ßÁªôÁ®çÊ∑±‰∏ÄÊ°£ÁöÑÈ¢úËâ≤
    textColorForOverall(level) {
      const l = (level || '').toLowerCase();
      if (l === 'none') return '#6B7280';
      if (l.includes('very low')) return '#2E7D32';
      if (l === 'low') return '#2F855A';
      if (l === 'moderate') return '#C05621';
      if (l === 'high') return '#C53030';
      if (l === 'very high') return '#9B2C2C';
      return '#2F855A';
    },

    // Advisory text and banner variant by level
    advisoryForLevel(level) {
      const l = (level || '').toLowerCase();
      if (l.includes('very low')) return { message: 'Great day to enjoy the outdoors!', variant: 'normal' };
      if (l === 'low') return { message: 'Good conditions ‚Äî outdoor activities are fine.', variant: 'normal' };
      if (l === 'moderate') return { message: 'Moderate ‚Äî consider a mask if you are sensitive.', variant: 'normal' };
      if (l === 'high') return { message: 'High levels ‚Äî limit outdoor time and keep meds handy.', variant: 'danger' };
      if (l === 'very high') return { message: 'Very high ‚Äî stay indoors if possible and close windows.', variant: 'danger' };
      return { message: 'Great day to enjoy the outdoors!', variant: 'normal' };
    }
  },
  
  watch: {},

  // Ensure addresses are loaded on mount and allow initial fetch
  // Á°Æ‰øùÁªÑ‰ª∂ÊåÇËΩΩÊó∂Âä†ËΩΩÂú∞ÂùÄÔºåÂπ∂Â∞ùËØïÁî®ÂΩìÂâçËæìÂÖ•ÂéªÂèñÊï∞
  mounted() {
    this.loadAddresses().then(() => {
      // Â¶ÇÊûúCSV‰∏≠Êâæ‰∏çÂà∞Á≤æÁ°ÆÂåπÈÖçÔºå‰πüÂÖÅËÆ∏Áõ¥Êé•‰ΩøÁî®ËæìÂÖ•ÂÄºËØ∑Ê±Ç‰∏ÄÊ¨°
      if (this.locationQuery) {
        this.loadDataForLocation(this.locationQuery);
      }
    });
    // init ring & text color
    this.chartRingColor = this.colorForOverall(this.pollenData.level);
    this.chartTextColor = this.textColorForOverall(this.pollenData.level);
      // Initialize local climate visualizations
      // ÂàùÂßãÂåñÊú¨Âú∞Ê∞îÂÄôÂèØËßÜÂåñ
      this.initClimateViz();
  }
}
</script>

<style scoped>
/* CSS Variables for consistent styling */
/* CSSÂèòÈáè - ‰øùÊåÅ‰∏ÄËá¥ÁöÑÊ†∑ÂºèÈ£éÊ†º */
:root {
  --primary-color: #239BA7;
  --secondary-color: #F9D65C;
  --text-primary: #000000;
  --text-secondary: #1E1E1E;
  --text-muted: #757575;
  --background-white: #FFFFFF;
  --background-off-white: #FFFDFD;
  --border-light: rgba(0, 0, 0, 0.1);
  --border-medium: #D9D9D9;
  --chart-blue: #4A9EFF;
  --chart-green: #4CAF50;
  --font-heading: 'Questrial', sans-serif;
  --font-body: 'Inter', sans-serif;
  --font-content: 'AR One Sans', sans-serif;
}

/* Dashboard container - main page wrapper */
/* DashboardÂÆπÂô® - ‰∏ªÈ°µÈù¢ÂåÖË£ÖÂô®
   - width: 100% Âç†Êª°Áà∂ÂÆπÂô®ÂÆΩÂ∫¶
   - max-width: 100vw ÈôêÂà∂ÊúÄÂ§ßÂÆΩÂ∫¶‰∏∫ËßÜÂè£ÂÆΩÂ∫¶
   - overflow-x: hidden ÈöêËóèÊ∞¥Âπ≥ÊªöÂä®
   - background: var(--background-white) ‰ΩøÁî®ÁôΩËâ≤ËÉåÊôØÂèòÈáè */
.dashboard {
  width: 100%;
  max-width: 100vw;
  overflow-x: hidden;
  background: var(--background-white);
}

/* Page container - center column with side gutters */
/* È°µÈù¢ÂÆπÂô® - ‰∏≠ÂøÉÊ†èÂä†‰∏§‰æßÁïôÁôΩ
   - max-width: 1200px ÊúÄÂ§ßÂÆΩÂ∫¶1200ÂÉèÁ¥†
   - margin: 0 auto Ê∞¥Âπ≥Â±Ö‰∏≠
   - padding: 0 24px Â∑¶Âè≥ÂÜÖËæπË∑ù24ÂÉèÁ¥† */
.page-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
}

/* Dashboard header - title, timestamp and controls */
/* DashboardÂ§¥ÈÉ® - Ê†áÈ¢ò„ÄÅÊó∂Èó¥Êà≥ÂíåÊéßÂà∂ÁªÑ‰ª∂
   - display: grid ÁΩëÊ†ºÂ∏ÉÂ±Ä
   - grid-template-columns: 1fr auto Â∑¶Ê†èÂç†Ââ©‰ΩôÁ©∫Èó¥ÔºåÂè≥Ê†èËá™ÈÄÇÂ∫îÂÜÖÂÆπ
   - align-items: start È°∂ÈÉ®ÂØπÈΩê
   - gap: 12px 24px Ë°åÈó¥Ë∑ù12pxÔºåÂàóÈó¥Ë∑ù24px
   - padding: 32px 0 24px ‰∏ä‰∏ãÂÜÖËæπË∑ùÔºöÈ°∂ÈÉ®32pxÔºåÂ∫ïÈÉ®24px */
.dashboard-header {
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: start;
  gap: 12px 24px;
  padding: 32px 0 24px;
}

/* Header left section - title and timestamp */
/* Â§¥ÈÉ®Â∑¶‰æßÂå∫Âüü - Ê†áÈ¢òÂíåÊó∂Èó¥Êà≥
   - display: flex ÂºπÊÄßÂ∏ÉÂ±Ä
   - flex-direction: column ÂûÇÁõ¥ÊéíÂàó
   - gap: 20px È°πÁõÆÈó¥Ë∑ù20ÂÉèÁ¥†ÔºåÂ¢ûÂä†Ê†áÈ¢ò‰∏éÊó∂Èó¥Êà≥Èó¥Ë∑ù */
.header-left {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* Header right section - controls */
/* Â§¥ÈÉ®Âè≥‰æßÂå∫Âüü - ÊéßÂà∂ÁªÑ‰ª∂
   - display: flex ÂºπÊÄßÂ∏ÉÂ±Ä
   - align-items: center ÂûÇÁõ¥Â±Ö‰∏≠
   - justify-content: flex-end Âè≥ÂØπÈΩê
   - gap: 12px È°πÁõÆÈó¥Ë∑ù12ÂÉèÁ¥† */
.header-right {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 12px;
}

/* Main dashboard title */
/* ‰∏ªDashboardÊ†áÈ¢ò
   - font-family: var(--font-heading) ‰ΩøÁî®Ê†áÈ¢òÂ≠ó‰ΩìÂèòÈáèQuestrial
   - font-size: clamp(40px, 4vw, 64px) ÂìçÂ∫îÂºèÂ≠ó‰ΩìÔºöÊúÄÂ∞è40pxÔºåÊúÄÂ§ß64px
   - font-weight: 400 Â≠ó‰ΩìÁ≤óÁªÜ400(Ê≠£Â∏∏)
   - line-height: 1 Ë°åÈ´ò‰∏∫1ÂÄçÂ≠ó‰ΩìÂ§ßÂ∞è
   - color: var(--text-primary) ‰ΩøÁî®‰∏ªË¶ÅÊñáÊú¨È¢úËâ≤ÂèòÈáè(ÈªëËâ≤)
   - margin: 0 0 8px Â∫ïÈÉ®Â§ñËæπË∑ù8ÂÉèÁ¥† */
.dashboard-title {
  font-family: var(--font-heading);
  font-size: clamp(40px, 4vw, 64px);
  font-weight: 400;
  line-height: 1;
  margin: 0;
  white-space: normal;
  color: var(--text-primary);
}

/* Last updated timestamp */
/* ÊúÄÂêéÊõ¥Êñ∞Êó∂Èó¥Êà≥
   - font-family: var(--font-heading) ‰ΩøÁî®Ê†áÈ¢òÂ≠ó‰ΩìÂèòÈáèQuestrial
   - font-size: clamp(16px, 2vw, 32px) ÂìçÂ∫îÂºèÂ≠ó‰ΩìÂ§ßÂ∞è
   - color: var(--text-primary) ‰ΩøÁî®‰∏ªË¶ÅÊñáÊú¨È¢úËâ≤(ÈªëËâ≤)
   - margin: 0 Êó†Â§ñËæπË∑ù */
.last-updated {
  font-family: var(--font-heading);
  font-size: 22px;
  color: #4A6F6A; /* slightly different tone to distinguish */
  margin: 0;
}

/* Location select dropdown */
/* Âú∞ÁÇπÈÄâÊã©‰∏ãÊãâÊ°Ü
   - margin: 0 ÁßªÈô§ÊâÄÊúâÂ§ñËæπË∑ù
   - display: flex ÂºπÊÄßÂ∏ÉÂ±Ä
   - align-items: center ÂûÇÁõ¥Â±Ö‰∏≠ */
.location-select {
  margin: 0;
  display: flex;
  align-items: center;
}

/* Autocomplete wrapper - Ëá™Âä®ÂÆåÊàêÂÆπÂô® */
.autocomplete {
  position: relative;
  width: 260px;
}

/* Override input width for new UI - ËæìÂÖ•Ê°ÜÂ∞∫ÂØ∏ */
.location-input {
  width: 100%;
}

/* Confirm button - Á°ÆËÆ§ÊåâÈíÆ */
.confirm-button {
  margin-left: 10px;
  height: 36px;
  padding: 8px 16px;
  background: #239BA7; /* brand primary */
  color: #FFFFFF;
  border: 0;
  border-radius: 10px;
  cursor: pointer;
  font-family: var(--font-body);
  font-size: 14px;
  font-weight: 600;
  transition: background-color 0.2s ease, transform 0.05s ease;
}

.confirm-button:hover {
  background: #1e8892;
}

.confirm-button:active {
  transform: translateY(1px);
}

/* Suggestions dropdown - ÂÄôÈÄâ‰∏ãÊãâ */
.suggestions {
  position: absolute;
  top: calc(100% + 6px);
  left: 0;
  right: 0;
  max-height: 260px;
  overflow: auto;
  background: #FFFFFF;
  border: 1px solid var(--border-light);
  border-radius: 8px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
  z-index: 1000;
  list-style: none;
  margin: 0;
  padding: 6px 0;
}

.suggestion-item {
  padding: 8px 12px;
  cursor: pointer;
}

.suggestion-item:hover {
  background: #F6F6F6;
}

/* ËæìÂÖ•Ê°ÜÊ†∑Âºè */
.location-input {
  width: 220px;                     /* Á®çÂæÆÂÆΩ‰∏ÄÁÇπÔºåÂÜÖÂÆπ‰∏ç‰ºöÊå§ */
  height: 36px;                     /* Êõ¥ÁüÆ‰∏Ä‰∫õ */
  padding: 6px 10px;
  font-family: var(--font-body, 'Inter', sans-serif);
  font-size: 15px;
  background: var(--background-white, #fff);
  border: 1px solid var(--border-medium, #ddd);
  border-radius: 10px;
  outline: none;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

/* ËÅöÁÑ¶Áä∂ÊÄÅÔºöÊõ¥ÊòéÊòæÁöÑËæπÊ°ÜÂíåÈò¥ÂΩ± */
.location-input:focus {
  border-color: #239BA7;            /* ÈùíÁªøËâ≤ËæπÊ°Ü */
  box-shadow: 0 0 0 2px rgba(35, 155, 167, 0.2);
}

/* Alert banner - warning message */
/* Ë≠¶Êä•Ê®™ÂπÖ - Ë≠¶ÂëäÊ∂àÊÅØ
   - display: inline-flex ÂÜÖËÅîÂºπÊÄßÂ∏ÉÂ±Ä
   - align-items: center ÂûÇÁõ¥Â±Ö‰∏≠
   - gap: 8px È°πÁõÆÈó¥Ë∑ù8ÂÉèÁ¥†
   - padding: 8px 12px ÂÜÖËæπË∑ùÔºö‰∏ä‰∏ã8pxÔºåÂ∑¶Âè≥12px
   - background: var(--secondary-color) ‰ΩøÁî®Ê¨°Ë¶ÅÈ¢úËâ≤ËÉåÊôØ(ÈªÑËâ≤#F9D65C)
   - border-radius: 12px ÂúÜËßí12ÂÉèÁ¥†
   - align-self: flex-start Âú®Áà∂ÂÆπÂô®‰∏≠Â∑¶ÂØπÈΩê */
.alert-banner {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: #F9D65C !important; /* default (normal) */
  border-radius: 12px;
  align-self: flex-start;
}

/* danger variant (for High/Very High) */
.alert-banner.danger {
  background: #FFCDD2 !important;
}

/* Alert text styling */
/* Ë≠¶Êä•ÊñáÊú¨Ê†∑Âºè
   - font-family: var(--font-body) ‰ΩøÁî®Ê≠£ÊñáÂ≠ó‰ΩìÂèòÈáèInter
   - font-size: 14px Â≠ó‰ΩìÂ§ßÂ∞è14ÂÉèÁ¥†
   - font-weight: 400 Â≠ó‰ΩìÁ≤óÁªÜ400(Ê≠£Â∏∏)
   - color: #2C2C2C Ê∑±ÁÅ∞Ëâ≤ÊñáÊú¨ */
.alert-text {
  margin: 0;
  padding: 0;
  font-family: var(--font-body);
  font-size: 14px;
  font-weight: 600;
  color: #2C2C2C;
  background: transparent;
  border: 0;
}

/* Main content section */
/* ‰∏ªÂÜÖÂÆπÂå∫Âüü
   - padding: 40px 0 ‰∏ä‰∏ãÂÜÖËæπË∑ù40ÂÉèÁ¥† */
.main-content {
  padding: 40px 0;
}

/* Content grid - two column layout */
/* ÂÜÖÂÆπÁΩëÊ†º - ÂèåÂàóÂ∏ÉÂ±Ä
   - display: grid ÁΩëÊ†ºÂ∏ÉÂ±Ä
   - grid-template-columns: 1fr 1fr ‰∏§ÂàóÁ≠âÂÆΩÂ∏ÉÂ±Ä
   - gap: 60px ÁΩëÊ†ºÈó¥Ë∑ù60ÂÉèÁ¥†
   - align-items: flex-start È°∂ÈÉ®ÂØπÈΩê */
.content-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 60px;
  align-items: flex-start;
}

/* Section titles - shared styling for chart and allergen titles */
/* Âå∫ÂüüÊ†áÈ¢ò - ÂõæË°®ÂíåËøáÊïèÂéüÊ†áÈ¢òÁöÑÂÖ±‰∫´Ê†∑Âºè
   - font-family: var(--font-body) ‰ΩøÁî®Ê≠£ÊñáÂ≠ó‰ΩìÂèòÈáèInter
   - font-size: clamp(20px, 2.5vw, 32px) ÂìçÂ∫îÂºèÂ≠ó‰ΩìÂ§ßÂ∞è
   - font-weight: 400 Â≠ó‰ΩìÁ≤óÁªÜ400(Ê≠£Â∏∏)
   - color: var(--text-primary) ‰∏ªË¶ÅÊñáÊú¨È¢úËâ≤(ÈªëËâ≤)
   - margin: 0 0 30px Â∫ïÈÉ®Â§ñËæπË∑ù30ÂÉèÁ¥†
   - text-align: center ÊñáÊú¨Â±Ö‰∏≠ */
.section-title {
  font-family: var(--font-body);
  font-size: clamp(20px, 2.5vw, 32px);
  font-weight: 400;
  color: var(--text-primary);
  margin: 0 0 30px;
  text-align: center;
}

/* Section titles - different alignment for each section */
/* Âå∫ÂüüÊ†áÈ¢ò - ‰∏çÂêåÂå∫ÂüüÁöÑÂØπÈΩêÊñπÂºè */
.chart-section .section-title {
  text-align: center; /* ÂõæË°®Ê†áÈ¢òÂ±Ö‰∏≠ÂØπÈΩêÔºå‰∏éÊåâÈíÆ‰øùÊåÅ‰∏ÄËá¥ */
}

.allergen-section .section-title {
  text-align: left; /* ËøáÊïèÂéüÊ†áÈ¢òÂ∑¶ÂØπÈΩê */
}

/* Chart section - left column */
/* ÂõæË°®Âå∫Âüü - Â∑¶Ê†è
   - width: 100% Âç†Êª°ÁΩëÊ†ºÂçïÂÖÉÊ†ºÂÆΩÂ∫¶
   - display: flex ÂºπÊÄßÂ∏ÉÂ±Ä
   - flex-direction: column ÂûÇÁõ¥ÊéíÂàó
   - align-items: flex-start Â∑¶ÂØπÈΩêÔºå‰∏éÂè≥Ê†è‰øùÊåÅ‰∏ÄËá¥
   - padding-top: 56px È°∂ÈÉ®ÂÜÖËæπË∑ùÔºå‰∏éÂè≥Ê†èË≠¶Êä•Ê®™ÂπÖÈ´òÂ∫¶ÂåπÈÖç */
.chart-section {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding-top: 56px;
}

/* Chart container - wrapper for circular chart */
/* ÂõæË°®ÂÆπÂô® - ÂúÜÂΩ¢ÂõæË°®ÂåÖË£ÖÂô®
   - position: relative Áõ∏ÂØπÂÆö‰Ωç
   - margin-bottom: 30px Â∫ïÈÉ®Â§ñËæπË∑ù30ÂÉèÁ¥† */
.chart-container {
  position: relative;
  margin-bottom: 30px;
}

/* Pollen chart - circular progress chart */
/* Ëä±Á≤âÂõæË°® - ÂúÜÂΩ¢ËøõÂ∫¶ÂõæË°®
   - position: relative Áõ∏ÂØπÂÆö‰Ωç
   - width: 342px ÂÆΩÂ∫¶342ÂÉèÁ¥†(‰∏éËÆæËÆ°Âõæ‰∏ÄËá¥)
   - height: 342px È´òÂ∫¶342ÂÉèÁ¥†(‰∏éËÆæËÆ°Âõæ‰∏ÄËá¥)
   - margin: 0 auto Ê∞¥Âπ≥Â±Ö‰∏≠ */
.pollen-chart {
  position: relative;
  width: 342px;
  height: 342px;
  margin: 0 auto;
}

/* Chart circle - outer circle with blue border */
/* ÂõæË°®ÂúÜÂúà - Â∏¶ËìùËâ≤ËæπÊ°ÜÁöÑÂ§ñÂúÜ
   - position: relative Áõ∏ÂØπÂÆö‰Ωç
   - width: 100% Âç†Êª°ÂÆπÂô®ÂÆΩÂ∫¶
   - height: 100% Âç†Êª°ÂÆπÂô®È´òÂ∫¶
   - border: 3px solid var(--chart-blue) 3ÂÉèÁ¥†ËìùËâ≤ËæπÊ°Ü
   - border-radius: 50% ÂúÜÂΩ¢
   - display: flex ÂºπÊÄßÂ∏ÉÂ±Ä
   - align-items: center ÂûÇÁõ¥Â±Ö‰∏≠
   - justify-content: center Ê∞¥Âπ≥Â±Ö‰∏≠
   - background: #f8f9fa ÊµÖÁÅ∞Ëâ≤ËÉåÊôØ */
/* Donut circle - gray ring with colored progress */
.chart-circle {
  position: relative;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  display: grid;
  place-items: center;
}

/* Render the ring on a pseudo-element so center text stays visible */
.chart-circle::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 50%;
  background: conic-gradient(
    var(--ring-color, #82D9B4) calc(var(--progress, 0) * 1%),
    #F6F7F9 0
  );
  mask: radial-gradient(circle at center, transparent 52%, #fff 53%);
  -webkit-mask: radial-gradient(circle at center, transparent 52%, #fff 53%);
}

/* remove old .chart-progress styles (donut does not need it) */

/* Chart center - inner circle with level text */
/* ÂõæË°®‰∏≠ÂøÉ - Â∏¶Á≠âÁ∫ßÊñáÊú¨ÁöÑÂÜÖÂúÜ
   - position: absolute ÁªùÂØπÂÆö‰Ωç
   - top: 50% ÂûÇÁõ¥Â±Ö‰∏≠
   - left: 50% Ê∞¥Âπ≥Â±Ö‰∏≠
   - transform: translate(-50%, -50%) Â±Ö‰∏≠ÂØπÈΩê
   - width: 250px ÂÆΩÂ∫¶250ÂÉèÁ¥†
   - height: 250px È´òÂ∫¶250ÂÉèÁ¥†
   - background: var(--background-white) ÁôΩËâ≤ËÉåÊôØ
   - border-radius: 50% ÂúÜÂΩ¢
   - display: flex ÂºπÊÄßÂ∏ÉÂ±Ä
   - align-items: center ÂûÇÁõ¥Â±Ö‰∏≠
   - justify-content: center Ê∞¥Âπ≥Â±Ö‰∏≠
   - z-index: 10 Â±ÇÁ∫ß10ÔºåÁ°Æ‰øùÂú®ËøõÂ∫¶Âºß‰πã‰∏ä */
.chart-center {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 250px;
  height: 250px;
  background: var(--background-white);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
}

/* Pollen level text - "Low" indicator */
/* Ëä±Á≤âÁ≠âÁ∫ßÊñáÊú¨ - "Low"ÊåáÁ§∫Âô®
   - font-family: var(--font-body) ‰ΩøÁî®Ê≠£ÊñáÂ≠ó‰ΩìÂèòÈáèInter
   - font-size: clamp(32px, 4vw, 48px) ÂìçÂ∫îÂºèÂ≠ó‰ΩìÂ§ßÂ∞è
   - font-weight: 600 Â≠ó‰ΩìÁ≤óÁªÜ600(Á≤ó‰Ωì)
   - color: var(--primary-color) ‰ΩøÁî®‰∏ªË¶ÅÈ¢úËâ≤(ÈùíËìùËâ≤)
   - text-align: center ÊñáÊú¨Â±Ö‰∏≠ */
.pollen-level {
  font-family: var(--font-body);
  font-size: clamp(24px, 3.2vw, 40px);
  font-weight: 600;
  color: var(--primary-color);
  text-align: center;
}

/* Chart corner handles - blue square indicators */
/* ÂõæË°®ËßíËêΩÊéßÂà∂ÁÇπ - ËìùËâ≤ÊñπÂΩ¢ÊåáÁ§∫Âô®
   - position: absolute ÁªùÂØπÂÆö‰Ωç
   - width: 8px ÂÆΩÂ∫¶8ÂÉèÁ¥†
   - height: 8px È´òÂ∫¶8ÂÉèÁ¥†
   - background: var(--chart-blue) ÂõæË°®ËìùËâ≤ËÉåÊôØ
   - border-radius: 1px ÂúÜËßí1ÂÉèÁ¥† */
.chart-handle {
  position: absolute;
  width: 8px;
  height: 8px;
  background: var(--chart-blue);
  border-radius: 1px;
}

/* Chart handle positions - ÂõæË°®ÊéßÂà∂ÁÇπ‰ΩçÁΩÆ */
.chart-handle.top-left {
  top: -4px;
  left: -4px;
}

.chart-handle.top-right {
  top: -4px;
  right: -4px;
}

.chart-handle.bottom-left {
  bottom: -4px;
  left: -4px;
}

.chart-handle.bottom-right {
  bottom: -4px;
  right: -4px;
}

/* Chart size indicator - dimensions display */
/* ÂõæË°®Â∞∫ÂØ∏ÊåáÁ§∫Âô® - Â∞∫ÂØ∏ÊòæÁ§∫
   - position: absolute ÁªùÂØπÂÆö‰Ωç
   - bottom: -40px Ë∑ùÁ¶ªÂõæË°®Â∫ïÈÉ®40ÂÉèÁ¥†
   - left: 50% Ê∞¥Âπ≥Â±Ö‰∏≠
   - transform: translateX(-50%) Â±Ö‰∏≠ÂØπÈΩê
   - font-family: var(--font-body) ‰ΩøÁî®Ê≠£ÊñáÂ≠ó‰ΩìÂèòÈáèInter
   - font-size: 14px Â≠ó‰ΩìÂ§ßÂ∞è14ÂÉèÁ¥†
   - font-weight: 600 Â≠ó‰ΩìÁ≤óÁªÜ600(Á≤ó‰Ωì)
   - background: var(--chart-blue) ÂõæË°®ËìùËâ≤ËÉåÊôØ
   - color: white ÁôΩËâ≤ÊñáÊú¨
   - padding: 6px 12px ÂÜÖËæπË∑ùÔºö‰∏ä‰∏ã6pxÔºåÂ∑¶Âè≥12px
   - border-radius: 4px ÂúÜËßí4ÂÉèÁ¥† */
.chart-size {
  position: absolute;
  bottom: -40px;
  left: 50%;
  transform: translateX(-50%);
  font-family: var(--font-body);
  font-size: 14px;
  font-weight: 600;
  background: var(--chart-blue);
  color: white;
  padding: 6px 12px;
  border-radius: 4px;
}

/* Forecast button - view 7-day forecast */
/* È¢ÑÊä•ÊåâÈíÆ - Êü•Áúã7Â§©È¢ÑÊä•
   - display: inline-flex ÂÜÖËÅîÂºπÊÄßÂ∏ÉÂ±Ä
   - align-items: center ÂûÇÁõ¥Â±Ö‰∏≠
   - justify-content: center Ê∞¥Âπ≥Â±Ö‰∏≠
   - padding: 12px 24px ÂÜÖËæπË∑ùÔºö‰∏ä‰∏ã12pxÔºåÂ∑¶Âè≥24px
   - font-family: var(--font-body) ‰ΩøÁî®Ê≠£ÊñáÂ≠ó‰ΩìÂèòÈáèInter
   - font-size: 16px Â≠ó‰ΩìÂ§ßÂ∞è16ÂÉèÁ¥†
   - font-weight: 600 Â≠ó‰ΩìÁ≤óÁªÜ600(Á≤ó‰Ωì)
   - background: var(--secondary-color) Ê¨°Ë¶ÅÈ¢úËâ≤ËÉåÊôØ(ÈªÑËâ≤)
   - border: 1px solid var(--secondary-color) ËæπÊ°ÜÈ¢úËâ≤‰∏éËÉåÊôØ‰∏ÄËá¥
   - border-radius: 16px ÂúÜËßí16ÂÉèÁ¥†
   - color: #303030 Ê∑±ÁÅ∞Ëâ≤ÊñáÊú¨
   - cursor: pointer Èº†Ê†áÊåáÈíàÊ†∑Âºè
   - transition: all 0.3s ease ÊâÄÊúâÂ±ûÊÄß0.3ÁßíÁºìÂä®ËøáÊ∏°
   - margin-top: 20px È°∂ÈÉ®Â§ñËæπË∑ù20ÂÉèÁ¥† */
.forecast-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 12px 24px;
  font-family: var(--font-body);
  font-size: 16px;
  font-weight: 600;
  background: var(--secondary-color);
  border: 1px solid var(--secondary-color);
  border-radius: 16px;
  color: #303030;
  cursor: pointer;
  transition: all 0.3s ease;
  margin-top: 20px;
  background-color: #F9D65C;
}

/* Forecast button hover effect */
/* È¢ÑÊä•ÊåâÈíÆÊÇ¨ÂÅúÊïàÊûú
   - transform: translateY(-2px) YËΩ¥Âêë‰∏äÁßªÂä®2ÂÉèÁ¥†
   - box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15) Â¢ûÂº∫Èò¥ÂΩ±ÊïàÊûú */
.forecast-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
}

/* Climate section container */
/* Ê∞îÂÄôÂèØËßÜÂåñÂå∫ÂüüÂÆπÂô®ÔºöÁ´ñÂêëÂ†ÜÂè†‰∏§‰∏™ÂõæË°®Âç°Áâá */
.climate-section {
  margin-top: 60px; /* ‰∏é‰∏äÊñπDashboardÊãâÂºÄÊõ¥Â§öË∑ùÁ¶ª */
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center; /* Âå∫ÂùóÊï¥‰ΩìÂ±Ö‰∏≠ */
  gap: 16px; /* ‰∏§ÂõæÊõ¥ÈõÜ‰∏≠ÔºåÂáèÂ∞ëÂûÇÁõ¥Èó¥Ë∑ù */
}

/* Visualization card wrapper */
/* ÂèØËßÜÂåñÂç°ÁâáÂ§ñÊ°ÜÔºöÁôΩÂ∫ï„ÄÅËΩªËæπÊ°Ü‰∏éÂúÜËßí */
.viz-card {
  width: 100%;
  max-width: 640px;  /* Á®çÂæÆÊõ¥Á™ÑÔºåËÆ©‰∏§ÂõæÊõ¥ÈõÜ‰∏≠ */
  margin: 0 auto;    /* Âç°ÁâáÂ±Ö‰∏≠ */
  background: var(--background-white);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  padding: 14px 12px 10px;
}

/* Short note under charts */
/* ÂõæË°®‰∏ãÊñπÁöÑÁÆÄÁü≠ËØ¥ÊòéÔºöÂ±Ö‰∏≠„ÄÅÁ™ÑË°åÂÆΩ„ÄÅÂº±ÂåñËâ≤ */
.viz-note {
  max-width: 640px;
  margin: 0 auto;
  text-align: center;
  font-family: var(--font-body);
  font-size: 14px;
  line-height: 1.5;
  color: #555;
}

/* Small title for viz */
/* ÂèØËßÜÂåñÂ∞èÊ†áÈ¢ò */
.viz-title {
  font-family: var(--font-body);
  font-size: 16px;
  font-weight: 600;
  color: var(--text-secondary);
  margin: 0 0 6px;
  text-align: left;
}

/* Shared SVG styles */
/* ÈÄöÁî®SVGÊ†∑ÂºèÔºöËΩ¥Á∫ø„ÄÅËôöÁ∫ø„ÄÅÁÇπ„ÄÅÊ†áÁ≠æÁ≠â */
.chart-svg { display: block; width: 100%; height: auto; }
.axis { stroke: #C7CCD1; stroke-width: 1; }
.median-line { stroke: #C9A74E; stroke-width: 1.5; stroke-dasharray: 4 4; }
.dot { fill: #F2A737; }
.dot-label { font-family: var(--font-body); font-size: 12px; fill: #333; }
.axis-label { font-family: var(--font-body); font-size: 12px; fill: #333; }
.tick { font-family: var(--font-body); font-size: 12px; fill: #333; }
.legend-label { font-family: var(--font-body); font-size: 12px; fill: #333; }

/* Allergen section - right column */
/* ËøáÊïèÂéüÂå∫Âüü - Âè≥Ê†è
   - width: 100% Âç†Êª°ÁΩëÊ†ºÂçïÂÖÉÊ†ºÂÆΩÂ∫¶
   - display: flex ÂºπÊÄßÂ∏ÉÂ±Ä
   - flex-direction: column ÂûÇÁõ¥ÊéíÂàó
   - gap: 16px È°πÁõÆÈó¥Ë∑ù16ÂÉèÁ¥† */
.allergen-section {
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* Allergen list - container for allergen items */
/* ËøáÊïèÂéüÂàóË°® - ËøáÊïèÂéüÈ°πÁõÆÂÆπÂô®
   - display: flex ÂºπÊÄßÂ∏ÉÂ±Ä
   - flex-direction: column ÂûÇÁõ¥ÊéíÂàó
   - gap: 16px È°πÁõÆÈó¥Ë∑ù16ÂÉèÁ¥†
   - margin-bottom: 40px Â∫ïÈÉ®Â§ñËæπË∑ù40ÂÉèÁ¥† */
.allergen-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin-bottom: 40px;
}

/* Individual allergen item */
/* Âçï‰∏™ËøáÊïèÂéüÈ°πÁõÆ
   - display: flex ÂºπÊÄßÂ∏ÉÂ±Ä
   - justify-content: space-between ‰∏§Á´ØÂØπÈΩê
   - align-items: center ÂûÇÁõ¥Â±Ö‰∏≠
   - padding: 16px 20px ÂÜÖËæπË∑ùÔºö‰∏ä‰∏ã16pxÔºåÂ∑¶Âè≥20px
   - background: var(--background-white) ÁôΩËâ≤ËÉåÊôØ
   - border: 1px solid var(--border-light) ÊµÖËâ≤ËæπÊ°Ü
   - border-radius: 12px ÂúÜËßí12ÂÉèÁ¥†
   - box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05) ËΩªÂæÆÈò¥ÂΩ±ÊïàÊûú */
.allergen-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px;
  background: var(--background-white);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

/* Allergen info - icon and name container */
/* ËøáÊïèÂéü‰ø°ÊÅØ - ÂõæÊ†áÂíåÂêçÁß∞ÂÆπÂô®
   - display: flex ÂºπÊÄßÂ∏ÉÂ±Ä
   - align-items: center ÂûÇÁõ¥Â±Ö‰∏≠
   - gap: 12px È°πÁõÆÈó¥Ë∑ù12ÂÉèÁ¥† */
.allergen-info {
  display: flex;
  align-items: center;
  gap: 8px;
}

/* Allergen icon styling */
/* ËøáÊïèÂéüÂõæÊ†áÊ†∑Âºè
   - font-size: 24px ÂõæÊ†áÂ§ßÂ∞è24ÂÉèÁ¥†
   - width: 32px ÂÆΩÂ∫¶32ÂÉèÁ¥†
   - height: 32px È´òÂ∫¶32ÂÉèÁ¥†
   - display: flex ÂºπÊÄßÂ∏ÉÂ±Ä
   - align-items: center ÂûÇÁõ¥Â±Ö‰∏≠
   - justify-content: center Ê∞¥Âπ≥Â±Ö‰∏≠ */
.allergen-icon {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

/* Allergen icon image styling */
/* ËøáÊïèÂéüÂõæÊ†áÂõæÁâáÊ†∑Âºè */
.allergen-icon img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/* Allergen name text */
/* ËøáÊïèÂéüÂêçÁß∞ÊñáÊú¨
   - font-family: var(--font-body) ‰ΩøÁî®Ê≠£ÊñáÂ≠ó‰ΩìÂèòÈáèInter
   - font-size: 18px Â≠ó‰ΩìÂ§ßÂ∞è18ÂÉèÁ¥†
   - font-weight: 500 Â≠ó‰ΩìÁ≤óÁªÜ500(‰∏≠Á≠âÁ≤ó‰Ωì)
   - color: var(--text-secondary) Ê¨°Ë¶ÅÊñáÊú¨È¢úËâ≤(Ê∑±ÁÅ∞Ëâ≤) */
.allergen-name {
  font-family: var(--font-body);
  font-size: 18px;
  font-weight: 500;
  color: var(--text-secondary);
}

/* Allergen level indicator */
/* ËøáÊïèÂéüÁ≠âÁ∫ßÊåáÁ§∫Âô®
   - font-family: var(--font-body) ‰ΩøÁî®Ê≠£ÊñáÂ≠ó‰ΩìÂèòÈáèInter
   - font-size: 16px Â≠ó‰ΩìÂ§ßÂ∞è16ÂÉèÁ¥†
   - font-weight: 600 Â≠ó‰ΩìÁ≤óÁªÜ600(Á≤ó‰Ωì)
   - padding: 6px 12px ÂÜÖËæπË∑ùÔºö‰∏ä‰∏ã6pxÔºåÂ∑¶Âè≥12px
   - border-radius: 20px ÂúÜËßí20ÂÉèÁ¥† */
.allergen-level {
  font-family: var(--font-body);
  font-size: 16px;
  font-weight: 600;
  padding: 6px 12px;
  border-radius: 20px;
}

/* Moderate level styling - orange background */
/* ‰∏≠Á≠âÁ≠âÁ∫ßÊ†∑Âºè - Ê©ôËâ≤ËÉåÊôØ
   - background: #FFF3E0 ÊµÖÊ©ôËâ≤ËÉåÊôØ
   - color: #F57C00 Ê©ôËâ≤ÊñáÊú¨ */
.allergen-level.moderate {
  background: #FFF3E0;
  color: #F57C00;
}

/* Low level styling - green background */
/* ‰ΩéÁ≠âÁ∫ßÊ†∑Âºè - ÁªøËâ≤ËÉåÊôØ
   - background: #E8F5E8 ÊµÖÁªøËâ≤ËÉåÊôØ
   - color: #4CAF50 ÁªøËâ≤ÊñáÊú¨ */
.allergen-level.low {
  background: #E8F5E8; /* lighter green */
  color: #43A047;
}

/* Very Low level styling - softer green */
/* Âæà‰ΩéÁ≠âÁ∫ßÊ†∑Âºè - Êõ¥ÊüîÂíåÁöÑÁªøËâ≤ */
.allergen-level.very-low {
  background: #C8E6C9; /* stronger green tint */
  color: #2E7D32;     /* deep green text */
}

/* Very High level styling - deep red */
/* ÂæàÈ´òÁ≠âÁ∫ßÊ†∑Âºè - Ê∑±Á∫¢Ëâ≤ */
.allergen-level.very-high {
  background: #FFCDD2;
  color: #C62828;
}

/* High level styling - red background */
/* È´òÁ≠âÁ∫ßÊ†∑Âºè - Á∫¢Ëâ≤ËÉåÊôØ
   - background: #FFEBEE ÊµÖÁ∫¢Ëâ≤ËÉåÊôØ
   - color: #F44336 Á∫¢Ëâ≤ÊñáÊú¨ */
.allergen-level.high {
  background: #FFEBEE;
  color: #F44336;
}

/* Good level styling - blue tone */
/* ËâØÂ•ΩÁ≠âÁ∫ßÊ†∑Âºè - ËìùËâ≤Ëâ≤Ë∞É */
.allergen-level.good {
  background: #C8E6C9; /* align with pollen green */
  color: #2E7D32;
}

/* Poor level styling - orange-red tone */
/* ËæÉÂ∑ÆÁ≠âÁ∫ßÊ†∑Âºè - Ê©ôÁ∫¢Ëâ≤Ë∞É */
.allergen-level.poor {
  background: #FBE9E7;
  color: #E64A19;
}

/* Fair level styling - yellow tone */
/* ‰∏ÄËà¨Á≠âÁ∫ßÊ†∑Âºè - ÈªÑËâ≤ */
.allergen-level.fair {
  background: #FFF3E0; /* same as Moderate */
  color: #F57C00;
}

/* Very Poor level styling - strong red */
/* ÂæàÂ∑ÆÁ≠âÁ∫ßÊ†∑Âºè - Âº∫Á∫¢Ëâ≤ */
.allergen-level.very-poor {
  background: #FFCDD2; /* deeper red like Very High */
  color: #C62828;
}

/* Extremely Poor level styling - darkest red */
/* ÊûÅÂ∑ÆÁ≠âÁ∫ßÊ†∑Âºè - ÊúÄÊ∑±Á∫¢ */
.allergen-level.extremely-poor {
  background: #FFCDD2;
  color: #B71C1C;
}

/* None/No data level styling - gray */
/* Êó†Êï∞ÊçÆ/Êó†Ëä±Á≤â Á≠âÁ∫ßÊ†∑Âºè - ÁÅ∞Ëâ≤ */
.allergen-level.none {
  background: #EEEEEE;
  color: #616161;
}

/* Unknown level styling - neutral gray */
/* Êú™Áü•Á≠âÁ∫ßÊ†∑Âºè - ‰∏≠ÊÄßÁÅ∞ */
.allergen-level.unknown {
  background: #EEEEEE;
  color: #616161;
}

/* Quiz CTA section */
/* ÊµãÈ™åË°åÂä®Âè∑Âè¨Âå∫Âüü
   - text-align: center ÊñáÊú¨Â±Ö‰∏≠
   - padding: 24px ÂÜÖËæπË∑ù24ÂÉèÁ¥†
   - background: #f8f9fa ÊµÖÁÅ∞Ëâ≤ËÉåÊôØ
   - border-radius: 12px ÂúÜËßí12ÂÉèÁ¥† */
.quiz-cta {
  text-align: center;
  padding: 24px;
  background: #f8f9fa;
  border-radius: 12px;
}

/* Quiz question text */
/* ÊµãÈ™åÈóÆÈ¢òÊñáÊú¨
   - font-family: var(--font-body) ‰ΩøÁî®Ê≠£ÊñáÂ≠ó‰ΩìÂèòÈáèInter
   - font-size: 16px Â≠ó‰ΩìÂ§ßÂ∞è16ÂÉèÁ¥†
   - color: var(--text-secondary) Ê¨°Ë¶ÅÊñáÊú¨È¢úËâ≤(Ê∑±ÁÅ∞Ëâ≤)
   - margin: 0 0 16px Â∫ïÈÉ®Â§ñËæπË∑ù16ÂÉèÁ¥† */
.quiz-question {
  font-family: var(--font-body);
  font-size: 16px;
  color: var(--text-secondary);
  margin: 0 0 16px;
}

/* Quiz button styling */
/* ÊµãÈ™åÊåâÈíÆÊ†∑Âºè
   - display: inline-flex ÂÜÖËÅîÂºπÊÄßÂ∏ÉÂ±Ä
   - align-items: center ÂûÇÁõ¥Â±Ö‰∏≠
   - justify-content: center Ê∞¥Âπ≥Â±Ö‰∏≠
   - padding: 10px 20px ÂÜÖËæπË∑ùÔºö‰∏ä‰∏ã10pxÔºåÂ∑¶Âè≥20px
   - font-family: var(--font-body) ‰ΩøÁî®Ê≠£ÊñáÂ≠ó‰ΩìÂèòÈáèInter
   - font-size: 14px Â≠ó‰ΩìÂ§ßÂ∞è14ÂÉèÁ¥†
   - font-weight: 500 Â≠ó‰ΩìÁ≤óÁªÜ500(‰∏≠Á≠âÁ≤ó‰Ωì)
   - background: transparent ÈÄèÊòéËÉåÊôØ
   - border: 1px solid var(--text-secondary) Ê¨°Ë¶ÅÊñáÊú¨È¢úËâ≤ËæπÊ°Ü
   - border-radius: 8px ÂúÜËßí8ÂÉèÁ¥†
   - color: var(--text-secondary) Ê¨°Ë¶ÅÊñáÊú¨È¢úËâ≤(Ê∑±ÁÅ∞Ëâ≤)
   - cursor: pointer Èº†Ê†áÊåáÈíàÊ†∑Âºè
   - transition: all 0.3s ease ÊâÄÊúâÂ±ûÊÄß0.3ÁßíÁºìÂä®ËøáÊ∏° */
.quiz-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 10px 20px;
  font-family: var(--font-body);
  font-size: 14px;
  font-weight: 500;
  background: transparent;
  border: 1px solid var(--text-secondary);
  border-radius: 8px;
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.3s ease;
  color: #4A9EFF;
}

/* Quiz button hover effect */
/* ÊµãÈ™åÊåâÈíÆÊÇ¨ÂÅúÊïàÊûú
   - background: var(--text-secondary) Ê¨°Ë¶ÅÊñáÊú¨È¢úËâ≤ËÉåÊôØ(Ê∑±ÁÅ∞Ëâ≤)
   - color: white ÁôΩËâ≤ÊñáÊú¨ */
.quiz-button:hover {
  background: var(--text-secondary);
  color: white;
}

/* Blue separator bar - divider between sections */
/* ËìùËâ≤ÂàÜÈöîÊù° - Âå∫ÂüüÈó¥ÂàÜÈöîÁ∫ø
   - width: 100% Âç†Êª°ÂÆπÂô®ÂÆΩÂ∫¶
   - height: 12px È´òÂ∫¶12ÂÉèÁ¥†
   - background: var(--primary-color) ‰∏ªË¶ÅÈ¢úËâ≤ËÉåÊôØ(ÈùíËìùËâ≤)
   - border-radius: 1px ÂúÜËßí1ÂÉèÁ¥†
   - margin: 40px 0 È°∂ÈÉ®ÂíåÂ∫ïÈÉ®Â§ñËæπË∑ù40ÂÉèÁ¥† */
.separator-bar {
  width: 100%;
  height: 12px;
  background: #239BA7 !important;
  border-radius: 1px;
  margin: 40px 0;
}

/* Tips section - advice and guidance */
/* ÊèêÁ§∫Âå∫Âüü - Âª∫ËÆÆÂíåÊåáÂØº
   - padding: 60px 0 ‰∏ä‰∏ãÂÜÖËæπË∑ù60ÂÉèÁ¥†
   - background: var(--background-off-white) ‰ΩøÁî®ÊµÖÁôΩËâ≤ËÉåÊôØ */
.tips-section {
  padding: 60px 0;
  background: var(--background-off-white);
}

/* Tips container - content wrapper */
/* ÊèêÁ§∫ÂÆπÂô® - ÂÜÖÂÆπÂåÖË£ÖÂô®
   - max-width: 1200px ÊúÄÂ§ßÂÆΩÂ∫¶1200ÂÉèÁ¥†
   - margin: 0 auto Ê∞¥Âπ≥Â±Ö‰∏≠
   - padding: 0 24px Â∑¶Âè≥ÂÜÖËæπË∑ù24ÂÉèÁ¥† */
.tips-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
}

/* Tips content - icon and text layout */
/* ÊèêÁ§∫ÂÜÖÂÆπ - ÂõæÊ†áÂíåÊñáÊú¨Â∏ÉÂ±Ä
   - display: flex ÂºπÊÄßÂ∏ÉÂ±Ä
   - align-items: flex-start È°∂ÈÉ®ÂØπÈΩê
   - gap: 30px È°πÁõÆÈó¥Ë∑ù30ÂÉèÁ¥† */
.tips-content {
  display: flex;
  align-items: center;
  gap: 30px;
}

/* Tips left section - icon and title */
/* ÊèêÁ§∫Â∑¶‰æßÂå∫Âüü - ÂõæÊ†áÂíåÊ†áÈ¢ò */
.tips-left {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  min-width: 200px;
}

/* Tips icon - image icon */
/* ÊèêÁ§∫ÂõæÊ†á - ÂõæÁâáÂõæÊ†á
   - width: 80px ÂõæÊ†áÂÆΩÂ∫¶80ÂÉèÁ¥†
   - height: 80px ÂõæÊ†áÈ´òÂ∫¶80ÂÉèÁ¥†
   - flex-shrink: 0 ‰∏çÁº©Â∞è
   - display: flex ÂºπÊÄßÂ∏ÉÂ±ÄÁî®‰∫éÂ±Ö‰∏≠ÂõæÁâá */
.tips-icon {
  width: 100px;
  height: 100px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Tips icon image styling */
/* ÊèêÁ§∫ÂõæÊ†áÂõæÁâáÊ†∑Âºè */
.tips-icon img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/* Tips text container */
/* ÊèêÁ§∫ÊñáÊú¨ÂÆπÂô®
   - flex: 1 Âç†ÊçÆÂâ©‰ΩôÁ©∫Èó¥
   - text-align: left ÊñáÊú¨Â∑¶ÂØπÈΩê */
.tips-text {
  flex: 1;
  text-align: left;
}

/* Tips section title */
/* ÊèêÁ§∫Âå∫ÂüüÊ†áÈ¢ò
   - font-family: var(--font-heading) ‰ΩøÁî®Ê†áÈ¢òÂ≠ó‰ΩìÂèòÈáèQuestrial
   - font-size: clamp(32px, 3vw, 48px) ÂìçÂ∫îÂºèÂ≠ó‰ΩìÂ§ßÂ∞è
   - font-weight: 400 Â≠ó‰ΩìÁ≤óÁªÜ400(Ê≠£Â∏∏)
   - color: var(--text-primary) ‰∏ªË¶ÅÊñáÊú¨È¢úËâ≤(ÈªëËâ≤)
   - margin: 0 0 20px Â∫ïÈÉ®Â§ñËæπË∑ù20ÂÉèÁ¥† */
.tips-title {
  font-family: var(--font-heading);
  font-size: clamp(32px, 3vw, 48px);
  font-weight: 400;
  color: var(--text-primary);
  margin: 0;
  text-align: center;
}

/* Main tip text - primary advice */
/* ‰∏ªË¶ÅÊèêÁ§∫ÊñáÊú¨ - ‰∏ªË¶ÅÂª∫ËÆÆ
   - font-family: var(--font-content) ‰ΩøÁî®ÂÜÖÂÆπÂ≠ó‰ΩìÂèòÈáèAR One Sans
   - font-size: clamp(24px, 2.5vw, 36px) ÂìçÂ∫îÂºèÂ≠ó‰ΩìÂ§ßÂ∞è
   - font-weight: 400 Â≠ó‰ΩìÁ≤óÁªÜ400(Ê≠£Â∏∏)
   - line-height: 1.2 Ë°åÈ´ò1.2ÂÄç
   - color: var(--text-primary) ‰∏ªË¶ÅÊñáÊú¨È¢úËâ≤(ÈªëËâ≤)
   - margin: 0 0 16px Â∫ïÈÉ®Â§ñËæπË∑ù16ÂÉèÁ¥† */
.tip-main {
  font-family: var(--font-content);
  font-size: clamp(22px, 2.2vw, 32px);
  font-weight: 400;
  line-height: 1.2;
  color: var(--text-primary);
  margin: 0 0 16px;
}

/* Tip description - explanatory text */
/* ÊèêÁ§∫ÊèèËø∞ - Ëß£ÈáäÊÄßÊñáÊú¨
   - font-family: var(--font-content) ‰ΩøÁî®ÂÜÖÂÆπÂ≠ó‰ΩìÂèòÈáèAR One Sans
   - font-size: clamp(18px, 1.5vw, 24px) ÂìçÂ∫îÂºèÂ≠ó‰ΩìÂ§ßÂ∞è
   - font-weight: 400 Â≠ó‰ΩìÁ≤óÁªÜ400(Ê≠£Â∏∏)
   - line-height: 1.2 Ë°åÈ´ò1.2ÂÄç
   - color: var(--text-primary) ‰∏ªË¶ÅÊñáÊú¨È¢úËâ≤(ÈªëËâ≤)
   - margin: 0 Êó†Â§ñËæπË∑ù */
.tip-description {
  font-family: var(--font-content);
  font-size: clamp(14px, 1.2vw, 18px);
  font-weight: 400;
  line-height: 1.2;
  color: var(--text-primary);
  margin: 0;
}

/* Responsive breakpoints */
/* ÂìçÂ∫îÂºèÊñ≠ÁÇπ */

/* Large screens (‚â•1440px) - Enhanced spacing */
/* Â§ßÂ±èÂπï (‚â•1440px) - Â¢ûÂº∫Èó¥Ë∑ù */
@media (min-width: 1440px) {
  /* Increase page container padding */
  /* Â¢ûÂä†È°µÈù¢ÂÆπÂô®ÂÜÖËæπË∑ù */
  .page-container {
    padding: 0 40px;
  }
  
  /* Increase tips container padding */
  /* Â¢ûÂä†ÊèêÁ§∫ÂÆπÂô®ÂÜÖËæπË∑ù */
  .tips-container {
    padding: 0 40px;
  }
}

/* Large screens (‚â•1200px) - Two column layout */
/* Â§ßÂ±èÂπï (‚â•1200px) - ‰∏§ÂàóÂ∏ÉÂ±Ä */
@media (min-width: 1200px) {
  /* Two column grid - equal width for better balance */
  /* ‰∏§ÂàóÁΩëÊ†º - Á≠âÂÆΩ‰ª•Ëé∑ÂæóÊõ¥Â•ΩÁöÑÂπ≥Ë°° */
  .content-grid {
    grid-template-columns: 1fr 1fr;
  }
}

/* Medium screens (768px-1199px) - Maintain two column layout */
/* ‰∏≠Á≠âÂ±èÂπï (768px-1199px) - ‰øùÊåÅ‰∏§ÂàóÂ∏ÉÂ±Ä */
@media (min-width: 768px) and (max-width: 1199px) {
  /* Reduce content grid gap */
  /* ÂáèÂ∞ëÂÜÖÂÆπÁΩëÊ†ºÈó¥Ë∑ù */
  .content-grid {
    gap: 40px;
    grid-template-columns: 1fr 1fr;
  }
  
  /* Adjust chart size for medium screens */
  /* ‰∏≠Á≠âÂ±èÂπïË∞ÉÊï¥ÂõæË°®Â§ßÂ∞è */
  .pollen-chart {
    width: 280px;
    height: 280px;
  }
  
  .chart-center {
    width: 200px;
    height: 200px;
  }
}

/* Small screens (<768px) - Single column layout */
/* Â∞èÂ±èÂπï (<768px) - ÂçïÂàóÂ∏ÉÂ±Ä */
@media (max-width: 767px) {
  /* Single column grid */
  /* ÂçïÂàóÁΩëÊ†º */
  .content-grid {
    grid-template-columns: 1fr;
    gap: 30px;
  }
  
  /* Stack header items vertically */
  /* Â§¥ÈÉ®È°πÁõÆÂûÇÁõ¥Â†ÜÂè† */
  .dashboard-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 20px;
  }
  
  .header-right {
    align-items: flex-start;
    width: 100%;
  }
  
  /* Full width location select */
  /* Âú∞ÁÇπÈÄâÊã©Âç†Êª°ÂÆΩÂ∫¶ */
  .location-input {
    width: 100%;
  }
  
  /* Adjust chart size for mobile */
  /* ÁßªÂä®Á´ØË∞ÉÊï¥ÂõæË°®Â§ßÂ∞è */
  .pollen-chart {
    width: 250px;
    height: 250px;
  }
  
  .chart-center {
    width: 180px;
    height: 180px;
  }
  
  /* Adjust tips layout for mobile */
  /* ÁßªÂä®Á´ØË∞ÉÊï¥ÊèêÁ§∫Â∏ÉÂ±Ä */
  .tips-content {
    flex-direction: column;
    text-align: center;
    gap: 20px;
  }
  
  /* Center tips icon on mobile */
  /* ÁßªÂä®Á´ØÂ±Ö‰∏≠ÊèêÁ§∫ÂõæÊ†á */
  .tips-icon {
    align-self: center;
  }
}
</style>